<% if current_user.places.count > 0 %> 
<header class="business-header">
   <div class="wrapper">
    <div class="map" id="map"></div>
    <i class="top"></i>
    <i class="right"></i>
    <i class="bottom"></i>
    <i class="left"></i>
    <i class="top left"></i>
    <i class="top right"></i>
    <i class="bottom left"></i>
    <i class="bottom right"></i>
</div>
<div class="container">
    <div class="row">
        <div class="col-lg-12">
           <script async defer
           src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA_oNEK2a5Mht0QETqahvFpLeD7bU6UkAw&callback=initMap">
       </script>
       <script src="//cdn.rawgit.com/mahnunchik/markerclustererplus/master/dist/markerclusterer.min.js"></script>
       <script src='//cdn.rawgit.com/printercu/google-maps-utility-library-v3-read-only/master/infobox/src/infobox_packed.js' type='text/javascript'></script> 
       <script>
          window.initMap = function() {
            var uluru = <%=raw @hash.to_json %>;
            console.log(uluru)
            var map = new google.maps.Map(document.getElementById('map'), {
              zoom: 4,
              center: uluru[0],
              draggable: true
          });

            for(i=0; i<uluru.length; i++) {
                var marker = new google.maps.Marker({
                    position: uluru[i],
                    map: map,
                    title: uluru[i].marker_title
                });
                (function(marker){
                    google.maps.event.addListener(marker, 'click', function(){
                        
                        var infowindow = new google.maps.InfoWindow({
                            content: marker.title
                        }); 
                        
                        infowindow.open(map,marker);
                    });
                })(marker);
        }
        function createMarker(position, title) {
            return new google.maps.Marker({
                position: {lat:lat, lng:lng  
                }, 
                map:map, 
                title: marker_title
            });
        }
    }
</script>
</div>
</div>
</div>
</header>
<div class="form-group search rounded">
    <%= form_tag(places_path, method: :get, id: "search-form") do %>
    <%= text_field_tag :search, params[:search], placeholder: 'Search' %>
    <%= button_tag '', class: "btn-img" %>
    <% end %>
</div>

<% if @places.present? %>

<% @places.each do |place| %>

<div class="center-block">
    <div class="col-md-3 col-sm-6 hero-feature">
        <div class="thumbnail">
            <a href="/places/<%= place.id%>"><div class="erven linkone"><img src="<%= place.logo %>" alt=""></div></a>
            <div class="caption">
                <address>
                    <span><%= place.name %></span>
                    <p><%= place.address %></p>
                    <p><%= place.phone %></p>
                </address>
                <p>Visited: <%= place.month %> <%= place.day %>, <%= place.year %> </p>
                <p>From: <%= place.time_from %> to: <%= place.time_to %> </p>
                <p>People: <%= place.users.count %></p>
                <p class="bottom_btns">
                    <%= link_to  image_tag('/images/trash.png'), place, method: :delete, data: { confirm: 'Are you sure?' }, class: "btn btn-default mybtn2" %>
                </p>
            </div>
        </div>
    </div>
    <% end %>
    <% else %>

    <p class="lead">
        <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
        There are no places containing the term(s) <span id="one"><%= params[:search] %>.</span></p>

        <% end %>

        <% else %> 
        <p class="text-info">There are no chosen places in your list.</p>
        <% end %>


        <style>

            .search input { 
                width: 280px;
                outline: none;
                padding:3px 10px 3px 10px;
                margin-left: 38%; 
                margin-bottom: 30px;

            }
            .rounded input { 
                border-radius:15px; 
                -moz-border-radius:15px; 
                -webkit-border-radius:15px; 
            }

            .btn-img {
                background: url('/images/search.png') no-repeat 3px 12px;
                margin-top: 3px;
                width: 36px;
                height: 36px;
                background-image:;
                border-color: #fff;
                outline: none;
                border:0;
            }
            .btn-default {
                margin-top: 10px;
                margin-left: 75px;
                border-radius: 5px;
                border:none !important;
                outline: none !important;
                background-color: transparent !important;

            }


            .btn-default img {
                width: 70px;
                height: auto;
            }

            .hero-feature {
                min-height: 320px;
            }

            .bottom_btns {
                position: absolute;
                top: 290px;
            }

            .lead, .text-info {
                text-align: center;
                font-family: 'Source Sans Pro', sans-serif;
            }

            .text-info {
                position: absolute;
                top: 50%;
                left: 40%;
                font-size: 20px;
                color: #fff;
            }   

            #one {
                color: #ed551e;
            }

        </style>

