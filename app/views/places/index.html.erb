
<% if current_user.places.count > 0 %> 
     <header class="business-header">
        <h3>Map</h3>
             <div id="map"></div>
                <div class="container">
                    <div class="row">
                        <div class="col-lg-12">
                         <script async defer
                            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA_oNEK2a5Mht0QETqahvFpLeD7bU6UkAw&callback=initMap">
                         </script>
                         <script src="//cdn.rawgit.com/mahnunchik/markerclustererplus/master/dist/markerclusterer.min.js"></script>
                         <script src='//cdn.rawgit.com/printercu/google-maps-utility-library-v3-read-only/master/infobox/src/infobox_packed.js' type='text/javascript'></script> 
                          <script>
                                  window.initMap = function() {
                                    var uluru = <%=raw @hash.to_json %>;
                                    var map = new google.maps.Map(document.getElementById('map'), {
                                      zoom: 4,
                                      center: uluru[0],
                                      draggable: true
                                    });

                                    for(i=0; i<uluru.length; i++) {
                                      new google.maps.Marker({
                                        position: uluru[i],
                                        map: map
                                      });
                                    }
                                    function createMarker(position) {
                                    return new google.maps.Marker({
                                    position: {lat:lat, lng:lng  
                                    }, 
                                    map:map
                                    });
                                    }
                                    
                                    // var infowindow = new google.maps.InfoWindow();
                                    // google.maps.event.addListener(marker, 'click', function() {
                                    //     alert("click");
                                    //   infowindow.setContent('<div><strong>' + 'click' + '</strong></div>');
                                    //   infowindow.open(map, this);
                                    // });
                                  }
                                </script>
                        </div>
                    </div>
                </div>
    </header>
    <div class="form-group search rounded">
    <%= form_tag(places_path, method: :get, id: "search-form") do %>
    	<%= text_field_tag :search, params[:search], placeholder: 'Search' %>
    		<%= button_tag '', class: "btn-img" %>
    <% end %>
    </div>

    <% if @places.present? %>

      <% @places.each do |place| %>

        <div class="center-block">
            <div class="col-md-3 col-sm-6 hero-feature">
                <div class="thumbnail">
                    <div class="erven"><img src="<%= place.logo %>" alt=""></div>
                        <div class="caption">
                        <address>
                        <h3><%= place.name %></h3>
                        <p><%= place.address %></p>
                        <p><%= place.phone %></p>
                        </address>
                        <p>Visited: <%= place.month %> <%= place.day %>, <%= place.year %> </p>
                        <p>From: <%= place.time_from %> to: <%= place.time_to %> </p>
                        <p class="bottom_btns">
                        <%= link_to 'More Info', place_path(place.id), class: "btn btn-default" %>
                        <%= link_to 'Delete', place, method: :delete, data: { confirm: 'Are you sure?' }, class: "btn btn-primary btn-large" %>
                        </p>
                    </div>
                </div>
            </div>
        <% end %>
    <% else %>

      <p class="lead">There are no places containing the term(s) <%= params[:search] %>.</p>


<% end %>

<% else %> 
    <p class="lead text-info">There are no chosen places in your list.</p>
<% end %>


<style>
    
    .search input { 
        width: 280px;
        outline: none;
        padding:3px 10px 3px 10px;
        margin-left: 38%; 
        margin-bottom: 30px;
        
    }
    .rounded input { 
        border-radius:15px; 
        -moz-border-radius:15px; 
        -webkit-border-radius:15px; 
    }

    .btn-img {
        background: url('/images/search.png') no-repeat 3px 12px;
        margin-top: 3px;
        width: 36px;
        height: 36px;
        background-image:;
        border-color: #fff;
        outline: none;
        border:0;
    }
    .btn-default, .btn-large {
        width: 100px;
        border-radius: 5px;
        margin-left: 15px;
    }


    .caption {
        min-height: 300px;
    }

    .hero-feature {
        min-height: 320px;
    }

    .bottom_btns {
        position: absolute;
        top: 290px;
    }

</style>